{
    "version": 3,
    "checkpoint": {
        "stack": "dev",
        "latest": {
            "manifest": {
                "time": "2019-03-19T01:10:46.191790818-07:00",
                "magic": "10484a8cdf491e982db0cd61c77ceebd9db887d282e029dd992b18630a2c5a32",
                "version": "v0.17.1",
                "plugins": [
                    {
                        "name": "nodejs",
                        "path": "/home/james/go/bin/pulumi-language-nodejs",
                        "type": "language",
                        "version": ""
                    },
                    {
                        "name": "kubernetes",
                        "path": "/home/james/.pulumi/plugins/resource-kubernetes-v0.20.1/pulumi-resource-kubernetes",
                        "type": "resource",
                        "version": "0.20.1"
                    },
                    {
                        "name": "pulumi-nodejs",
                        "path": "/home/james/.pulumi/bin/pulumi-resource-pulumi-nodejs",
                        "type": "resource",
                        "version": "0.16.14"
                    }
                ]
            },
            "resources": [
                {
                    "urn": "urn:pulumi:dev::pulumi-ts::pulumi:pulumi:Stack::pulumi-ts-dev",
                    "custom": false,
                    "type": "pulumi:pulumi:Stack",
                    "outputs": {
                        "app": {
                            "name": "my-app",
                            "options": {
                                "port": 3000,
                                "provider": {
                                    "context": "minikube",
                                    "id": "bd04726e-728a-4c2f-bc47-10193eabecc1",
                                    "urn": "urn:pulumi:dev::pulumi-ts::pulumi:providers:kubernetes::minikube"
                                },
                                "src": "/home/james/learning-pulumi/pulumi-ts/app"
                            },
                            "urn": "urn:pulumi:dev::pulumi-ts::app::my-app"
                        }
                    }
                },
                {
                    "urn": "urn:pulumi:dev::pulumi-ts::app::my-app",
                    "custom": false,
                    "type": "app",
                    "parent": "urn:pulumi:dev::pulumi-ts::pulumi:pulumi:Stack::pulumi-ts-dev"
                },
                {
                    "urn": "urn:pulumi:dev::pulumi-ts::pulumi:providers:kubernetes::minikube",
                    "custom": true,
                    "id": "bd04726e-728a-4c2f-bc47-10193eabecc1",
                    "type": "pulumi:providers:kubernetes",
                    "inputs": {
                        "context": "minikube"
                    },
                    "parent": "urn:pulumi:dev::pulumi-ts::pulumi:pulumi:Stack::pulumi-ts-dev",
                    "propertyDependencies": {
                        "context": null
                    }
                },
                {
                    "urn": "urn:pulumi:dev::pulumi-ts::pulumi:providers:pulumi-nodejs::default",
                    "custom": true,
                    "id": "2eb3917b-cdd0-46df-9b7f-d14dfb32499d",
                    "type": "pulumi:providers:pulumi-nodejs"
                },
                {
                    "urn": "urn:pulumi:dev::pulumi-ts::pulumi:providers:kubernetes::default",
                    "custom": true,
                    "id": "3ce8a23e-bd9e-4180-ae20-8190c50ea5ba",
                    "type": "pulumi:providers:kubernetes",
                    "inputs": {
                        "version": "0.20.1"
                    }
                },
                {
                    "urn": "urn:pulumi:dev::pulumi-ts::pulumi-nodejs:dynamic:Resource::my-app-image",
                    "custom": true,
                    "id": "sha256:f2d0f71eac8328d02837d6918e08738abafce469d524a9ee913f73b4442aac28",
                    "type": "pulumi-nodejs:dynamic:Resource",
                    "inputs": {
                        "__provider": "exports.handler = __f0;\n\nvar __provider_proto = {};\n__f1.prototype = __provider_proto;\nObject.defineProperty(__provider_proto, \"constructor\", { configurable: true, writable: true, value: __f1 });\nObject.defineProperty(__provider_proto, \"create\", { configurable: true, writable: true, value: __f2 });\nObject.defineProperty(__provider_proto, \"delete\", { configurable: true, writable: true, value: __f4 });\nvar __provider = Object.create(__provider_proto);\n\nfunction __f1() {\n  return (function() {\n    with({  }) {\n\nreturn function /*constructor*/() { };\n\n    }\n  }).apply(undefined, undefined).apply(this, arguments);\n}\n\nfunction __f3() {\n  return (function() {\n    with({  }) {\n\nreturn function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n    }\n  }).apply(undefined, undefined).apply(this, arguments);\n}\n\nfunction __exec() {\n  return (function() {\n    with({ cp: require(\"child_process\"), exec: __exec }) {\n\nreturn function /*exec*/(command, options = { cwd: process.cwd() }) {\n    return new Promise((resolve, reject) =\u003e {\n        cp.exec(command, Object.assign({}, options), (err, stdout, stderr) =\u003e {\n            if (err) {\n                reject(err);\n                return;\n            }\n            resolve({ stdout, stderr });\n        });\n    });\n};\n\n    }\n  }).apply(undefined, undefined).apply(this, arguments);\n}\n\nfunction __f2() {\n  return (function() {\n    with({ __awaiter: __f3, exec: __exec }) {\n\nreturn function /*create*/(inputs) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const imageName = inputs.localImageName;\n            const context = inputs.build;\n            const { stdout } = yield exec(`docker build -q -t ${imageName} ${context}`);\n            const imageId = stdout.trim();\n            return {\n                id: stdout.trim(),\n                outs: {\n                    sha: imageId,\n                }\n            };\n        });\n    };\n\n    }\n  }).apply(undefined, undefined).apply(this, arguments);\n}\n\nfunction __f4() {\n  return (function() {\n    with({ __awaiter: __f3, exec: __exec }) {\n\nreturn function /*delete*/(id, props) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield exec(`docker rmi ${id}`);\n        });\n    };\n\n    }\n  }).apply(undefined, undefined).apply(this, arguments);\n}\n\nfunction __f0() {\n  return (function() {\n    with({ provider: __provider }) {\n\nreturn () =\u003e provider;\n\n    }\n  }).apply(undefined, undefined).apply(this, arguments);\n}\n",
                        "build": "/home/james/learning-pulumi/pulumi-ts/app",
                        "imageName": "my-app",
                        "localImageName": "my-app"
                    },
                    "outputs": {
                        "__provider": "exports.handler = __f0;\n\nvar __provider_proto = {};\n__f1.prototype = __provider_proto;\nObject.defineProperty(__provider_proto, \"constructor\", { configurable: true, writable: true, value: __f1 });\nObject.defineProperty(__provider_proto, \"create\", { configurable: true, writable: true, value: __f2 });\nObject.defineProperty(__provider_proto, \"delete\", { configurable: true, writable: true, value: __f4 });\nvar __provider = Object.create(__provider_proto);\n\nfunction __f1() {\n  return (function() {\n    with({  }) {\n\nreturn function /*constructor*/() { };\n\n    }\n  }).apply(undefined, undefined).apply(this, arguments);\n}\n\nfunction __f3() {\n  return (function() {\n    with({  }) {\n\nreturn function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n    }\n  }).apply(undefined, undefined).apply(this, arguments);\n}\n\nfunction __exec() {\n  return (function() {\n    with({ cp: require(\"child_process\"), exec: __exec }) {\n\nreturn function /*exec*/(command, options = { cwd: process.cwd() }) {\n    return new Promise((resolve, reject) =\u003e {\n        cp.exec(command, Object.assign({}, options), (err, stdout, stderr) =\u003e {\n            if (err) {\n                reject(err);\n                return;\n            }\n            resolve({ stdout, stderr });\n        });\n    });\n};\n\n    }\n  }).apply(undefined, undefined).apply(this, arguments);\n}\n\nfunction __f2() {\n  return (function() {\n    with({ __awaiter: __f3, exec: __exec }) {\n\nreturn function /*create*/(inputs) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const imageName = inputs.localImageName;\n            const context = inputs.build;\n            const { stdout } = yield exec(`docker build -q -t ${imageName} ${context}`);\n            const imageId = stdout.trim();\n            return {\n                id: stdout.trim(),\n                outs: {\n                    sha: imageId,\n                }\n            };\n        });\n    };\n\n    }\n  }).apply(undefined, undefined).apply(this, arguments);\n}\n\nfunction __f4() {\n  return (function() {\n    with({ __awaiter: __f3, exec: __exec }) {\n\nreturn function /*delete*/(id, props) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield exec(`docker rmi ${id}`);\n        });\n    };\n\n    }\n  }).apply(undefined, undefined).apply(this, arguments);\n}\n\nfunction __f0() {\n  return (function() {\n    with({ provider: __provider }) {\n\nreturn () =\u003e provider;\n\n    }\n  }).apply(undefined, undefined).apply(this, arguments);\n}\n",
                        "sha": "sha256:f2d0f71eac8328d02837d6918e08738abafce469d524a9ee913f73b4442aac28"
                    },
                    "parent": "urn:pulumi:dev::pulumi-ts::pulumi:pulumi:Stack::pulumi-ts-dev",
                    "provider": "urn:pulumi:dev::pulumi-ts::pulumi:providers:pulumi-nodejs::default::2eb3917b-cdd0-46df-9b7f-d14dfb32499d",
                    "propertyDependencies": {
                        "__provider": null,
                        "build": null,
                        "imageName": null,
                        "localImageName": null
                    }
                },
                {
                    "urn": "urn:pulumi:dev::pulumi-ts::app$kubernetes:apps/v1:Deployment::my-app-deployment",
                    "custom": true,
                    "id": "default/my-app",
                    "type": "kubernetes:apps/v1:Deployment",
                    "inputs": {
                        "apiVersion": "apps/v1",
                        "kind": "Deployment",
                        "metadata": {
                            "labels": {
                                "name": "my-app"
                            },
                            "name": "my-app",
                            "namespace": "default"
                        },
                        "spec": {
                            "replicas": 1,
                            "selector": {
                                "matchLabels": {
                                    "name": "my-app"
                                }
                            },
                            "template": {
                                "metadata": {
                                    "labels": {
                                        "name": "my-app"
                                    }
                                },
                                "spec": {
                                    "containers": [
                                        {
                                            "envFrom": [],
                                            "image": "my-app",
                                            "imagePullPolicy": "IfNotPresent",
                                            "name": "my-app",
                                            "ports": [
                                                {
                                                    "containerPort": 3000
                                                }
                                            ]
                                        }
                                    ]
                                }
                            }
                        }
                    },
                    "outputs": {
                        "__inputs": {
                            "apiVersion": "apps/v1",
                            "kind": "Deployment",
                            "metadata": {
                                "labels": {
                                    "name": "my-app"
                                },
                                "name": "my-app",
                                "namespace": "default"
                            },
                            "spec": {
                                "replicas": 1,
                                "selector": {
                                    "matchLabels": {
                                        "name": "my-app"
                                    }
                                },
                                "template": {
                                    "metadata": {
                                        "labels": {
                                            "name": "my-app"
                                        }
                                    },
                                    "spec": {
                                        "containers": [
                                            {
                                                "envFrom": [],
                                                "image": "my-app",
                                                "imagePullPolicy": "IfNotPresent",
                                                "name": "my-app",
                                                "ports": [
                                                    {
                                                        "containerPort": 3000
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            }
                        },
                        "apiVersion": "apps/v1",
                        "kind": "Deployment",
                        "metadata": {
                            "annotations": {
                                "deployment.kubernetes.io/revision": "1"
                            },
                            "creationTimestamp": "2019-03-19T08:10:33Z",
                            "generation": 1,
                            "labels": {
                                "name": "my-app"
                            },
                            "name": "my-app",
                            "namespace": "default",
                            "resourceVersion": "11853",
                            "selfLink": "/apis/apps/v1/namespaces/default/deployments/my-app",
                            "uid": "78249a52-4a1e-11e9-ba02-000c29997d29"
                        },
                        "spec": {
                            "progressDeadlineSeconds": 600,
                            "replicas": 1,
                            "revisionHistoryLimit": 10,
                            "selector": {
                                "matchLabels": {
                                    "name": "my-app"
                                }
                            },
                            "strategy": {
                                "rollingUpdate": {
                                    "maxSurge": "25%",
                                    "maxUnavailable": "25%"
                                },
                                "type": "RollingUpdate"
                            },
                            "template": {
                                "metadata": {
                                    "labels": {
                                        "name": "my-app"
                                    }
                                },
                                "spec": {
                                    "containers": [
                                        {
                                            "image": "my-app",
                                            "imagePullPolicy": "IfNotPresent",
                                            "name": "my-app",
                                            "ports": [
                                                {
                                                    "containerPort": 3000,
                                                    "protocol": "TCP"
                                                }
                                            ],
                                            "resources": {},
                                            "terminationMessagePath": "/dev/termination-log",
                                            "terminationMessagePolicy": "File"
                                        }
                                    ],
                                    "dnsPolicy": "ClusterFirst",
                                    "restartPolicy": "Always",
                                    "schedulerName": "default-scheduler",
                                    "securityContext": {},
                                    "terminationGracePeriodSeconds": 30
                                }
                            }
                        },
                        "status": {
                            "availableReplicas": 1,
                            "conditions": [
                                {
                                    "lastTransitionTime": "2019-03-19T08:10:36Z",
                                    "lastUpdateTime": "2019-03-19T08:10:36Z",
                                    "message": "Deployment has minimum availability.",
                                    "reason": "MinimumReplicasAvailable",
                                    "status": "True",
                                    "type": "Available"
                                },
                                {
                                    "lastTransitionTime": "2019-03-19T08:10:33Z",
                                    "lastUpdateTime": "2019-03-19T08:10:36Z",
                                    "message": "ReplicaSet \"my-app-5f84c9f7ff\" has successfully progressed.",
                                    "reason": "NewReplicaSetAvailable",
                                    "status": "True",
                                    "type": "Progressing"
                                }
                            ],
                            "observedGeneration": 1,
                            "readyReplicas": 1,
                            "replicas": 1,
                            "updatedReplicas": 1
                        }
                    },
                    "parent": "urn:pulumi:dev::pulumi-ts::app::my-app",
                    "dependencies": [
                        "urn:pulumi:dev::pulumi-ts::pulumi-nodejs:dynamic:Resource::my-app-image"
                    ],
                    "provider": "urn:pulumi:dev::pulumi-ts::pulumi:providers:kubernetes::minikube::bd04726e-728a-4c2f-bc47-10193eabecc1",
                    "propertyDependencies": {
                        "apiVersion": null,
                        "kind": null,
                        "metadata": null,
                        "spec": [
                            "urn:pulumi:dev::pulumi-ts::pulumi-nodejs:dynamic:Resource::my-app-image"
                        ]
                    }
                },
                {
                    "urn": "urn:pulumi:dev::pulumi-ts::kubernetes:core/v1:Service::my-app-service",
                    "custom": true,
                    "id": "default/my-app",
                    "type": "kubernetes:core/v1:Service",
                    "inputs": {
                        "apiVersion": "v1",
                        "kind": "Service",
                        "metadata": {
                            "labels": {
                                "name": "my-app"
                            },
                            "name": "my-app",
                            "namespace": "default"
                        },
                        "spec": {
                            "ports": [
                                {
                                    "port": 3000,
                                    "targetPort": 3000
                                }
                            ],
                            "selector": {
                                "name": "my-app"
                            },
                            "type": "ClusterIP"
                        }
                    },
                    "outputs": {
                        "__inputs": {
                            "apiVersion": "v1",
                            "kind": "Service",
                            "metadata": {
                                "labels": {
                                    "name": "my-app"
                                },
                                "name": "my-app",
                                "namespace": "default"
                            },
                            "spec": {
                                "ports": [
                                    {
                                        "port": 3000,
                                        "targetPort": 3000
                                    }
                                ],
                                "selector": {
                                    "name": "my-app"
                                },
                                "type": "ClusterIP"
                            }
                        },
                        "apiVersion": "v1",
                        "kind": "Service",
                        "metadata": {
                            "creationTimestamp": "2019-03-19T08:09:50Z",
                            "labels": {
                                "name": "my-app"
                            },
                            "name": "my-app",
                            "namespace": "default",
                            "resourceVersion": "11778",
                            "selfLink": "/api/v1/namespaces/default/services/my-app",
                            "uid": "5e9422e5-4a1e-11e9-ba02-000c29997d29"
                        },
                        "spec": {
                            "clusterIP": "10.98.61.180",
                            "ports": [
                                {
                                    "port": 3000,
                                    "protocol": "TCP",
                                    "targetPort": 3000
                                }
                            ],
                            "selector": {
                                "name": "my-app"
                            },
                            "sessionAffinity": "None",
                            "type": "ClusterIP"
                        },
                        "status": {
                            "loadBalancer": {}
                        }
                    },
                    "parent": "urn:pulumi:dev::pulumi-ts::pulumi:pulumi:Stack::pulumi-ts-dev",
                    "provider": "urn:pulumi:dev::pulumi-ts::pulumi:providers:kubernetes::default::3ce8a23e-bd9e-4180-ae20-8190c50ea5ba",
                    "propertyDependencies": {
                        "apiVersion": null,
                        "kind": null,
                        "metadata": null,
                        "spec": null
                    }
                }
            ]
        }
    }
}